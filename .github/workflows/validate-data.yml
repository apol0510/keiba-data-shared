name: Validate Results Data Format

on:
  push:
    branches:
      - main
    paths:
      - 'nankan/results/**/*.json'
      - 'nankan/predictions/**/*.json'
  pull_request:
    paths:
      - 'nankan/results/**/*.json'
      - 'nankan/predictions/**/*.json'

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Run validation
        run: |
          echo "ğŸ” çµæœãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã¾ã™..."
          node scripts/validate-results.js

      - name: Validation success
        if: success()
        run: |
          echo "âœ… å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™"

      - name: Validation failed
        if: failure()
        run: |
          echo "âŒ ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™"
          echo "ä¿®æ­£æ–¹æ³•:"
          echo "  1. å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: date, venue, races"
          echo "  2. ç¦æ­¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: raceDate, track, totalRaces, lastUpdated"
          echo "  3. venueCode ã‚’è¿½åŠ ï¼ˆOI, KA, FU, URï¼‰"
          exit 1
