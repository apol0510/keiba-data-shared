name: Trigger Netlify Build on Data Update (å—é–¢ãƒ»JRA)

on:
  push:
    branches:
      - main
    paths:
      - 'nankan/results/**/*.json'
      - 'nankan/predictions/**/*.json'
      - 'jra/results/**/*.json'
      - 'jra/predictions/**/*.json'

jobs:
  trigger-netlify:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger Netlify Build Hook
        run: |
          echo "ğŸš€ Netlifyãƒ“ãƒ«ãƒ‰ãƒ•ãƒƒã‚¯ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ˆå—é–¢ãƒ»JRAçµæœ/äºˆæƒ³ãƒ‡ãƒ¼ã‚¿æ›´æ–°ï¼‰..."
          response=$(curl -X POST -d {} -w "\nHTTP_CODE:%{http_code}" "${{ secrets.NETLIFY_BUILD_HOOK_URL }}")
          http_code=$(echo "$response" | grep "HTTP_CODE" | cut -d: -f2)

          if [ "$http_code" = "200" ] || [ "$http_code" = "204" ]; then
            echo "âœ… Netlifyãƒ“ãƒ«ãƒ‰ã‚’æ­£å¸¸ã«ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã—ãŸ (HTTP $http_code)"
            echo "ğŸ“„ æ–°ã—ã„ãƒšãƒ¼ã‚¸ãŒ5-10åˆ†ä»¥å†…ã«ç”Ÿæˆã•ã‚Œã¾ã™"
          else
            echo "âŒ Netlifyãƒ“ãƒ«ãƒ‰ã®ãƒˆãƒªã‚¬ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ (HTTP $http_code)"
            echo "Response: $response"
            exit 1
          fi
